function cl(a){console.log(a)}function toLecture(b){try{var c=b.properties.kuupaev.values[0].value}catch(d){var c=""}try{var f=b.properties.kirjeldus.values[0].value}catch(d){var f=""}try{var g=b.properties.nimi.values[0].value}catch(d){var g=""}try{var h=b.properties.esitaja.values}catch(d){var h=[]}try{var i=b.properties.toimetaja.values}catch(d){var i=[]}try{var j=b.properties.muusika.values}catch(d){var j=[]}try{var k=b.properties.heli.values}catch(d){var k=[]}try{var l=b.properties.teised.values}catch(d){var l=[]}try{var n=b.properties.link.values[0].value}catch(d){var n=""}var p=[];for(a in h)p.push(h[a].value);var q=[];for(e in i)q.push(i[e].value);var r=[];for(m in j)r.push(j[m].value);var t=[];for(s in k)t.push(k[s].value);var u=[];for(o in l)u.push(l[o].value);return{id:b.id,description:f,date:c,year:c.substring(0,4),title:g,author:p.sort(),editor:q.sort(),music:r.sort(),sound:t.sort(),other:u.sort(),link:n}}var entuURL="https://ylikool.entu.ee/api2/";angular.module("ylikoolApp",["ngRoute"]).config(["$routeProvider","$sceDelegateProvider",function(a,b){a.when("/ajatelg",{templateUrl:"pages/history.html",controller:"listCtrl"}).when("/konelejad",{templateUrl:"pages/authors.html",controller:"listCtrl"}).when("/:id",{templateUrl:"pages/lecture.html",controller:"lectureCtrl"}).otherwise({redirectTo:"/ajatelg"}),b.resourceUrlWhitelist(["self","http://heli.er.ee/**"])}]).controller("mainCtrl",["$rootScope","$scope","$location",function(a,b,c){a.url=c.path().replace("/",""),b.nightTipNr=Math.floor(3*Math.random()+1),b.pages=[{url:"ajatelg",title:"Ajatelg"},{url:"konelejad",title:"K\xf5nelejad"}],b.nightToggle=function(){b.nightMode=!b.nightMode,b.hideNightTip=!0}}]).controller("listCtrl",["$rootScope","$scope","$http","$location",function(b,c,d,e){b.url=e.path().replace("/",""),b.lectures||b.years||b.authors?(c.lectures=b.lectures,c.years=b.years,c.authors=b.authors):d({method:"GET",url:entuURL+"entity",params:{definition:"loeng"}}).success(function(e){b.lectures_count=e.result.length,b.lectures_loaded=0,b.lectures=[],b.years=[],b.authors=[];for(i in e.result)d({method:"GET",url:entuURL+"entity-"+e.result[i].id}).success(function(d){var e=toLecture(d.result);b.lectures.push(e),-1==b.years.indexOf(e.year)&&(b.years.push(e.year),b.years=b.years.sort(),b.years=b.years.reverse());for(a in e.author)-1==b.authors.indexOf(e.author[a])&&(b.authors.push(e.author[a]),b.authors=b.authors.sort());c.lectures=b.lectures,c.years=b.years,c.authors=b.authors,b.lectures_loaded+=1})})}]).controller("lectureCtrl",["$rootScope","$scope","$http","$routeParams",function(a,b,c,d){a.url=d.id,c({method:"GET",url:entuURL+"entity-"+d.id}).success(function(a){b.lecture=toLecture(a.result)}),b.palyAudio=function(b){a.current_lecture=b}}]);
