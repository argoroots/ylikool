function cl(a){console.log(a)}function toLecture(b){try{var c=b.properties.kuupaev.values[0].value}catch(d){var c=""}try{var e=b.properties.nimi.values[0].value}catch(d){var e=""}try{var f=b.properties.esitaja.values}catch(d){var f=[]}try{var g=b.properties.link.values[0].value}catch(d){var g=""}var h=[];for(a in f)h.push(f[a].value);return{id:b.id,date:c,year:c.substring(0,4),title:e,authors:h,link:g}}var entuURL="https://ylikool.entu.ee/api2/";angular.module("ylikoolApp",["ngRoute"]).config(["$routeProvider","$sceDelegateProvider",function(a,b){a.when("/ajatelg",{templateUrl:"pages/history.html",controller:"listCtrl"}).when("/konelejad",{templateUrl:"pages/authors.html",controller:"listCtrl"}).when("/:id",{templateUrl:"pages/lecture.html",controller:"lectureCtrl"}).otherwise({redirectTo:"/ajatelg"}),b.resourceUrlWhitelist(["self","http://heli.er.ee/**"])}]).controller("mainCtrl",["$rootScope","$scope","$location",function(a,b,c){a.url=c.path().replace("/",""),b.nightTipNr=Math.floor(3*Math.random()+1),b.pages=[{url:"ajatelg",title:"Ajatelg"},{url:"konelejad",title:"K\xf5nelejad"}],b.nightToggle=function(){b.nightMode=!b.nightMode,b.hideNightTip=!0}}]).controller("listCtrl",["$rootScope","$scope","$http","$location",function(b,c,d,e){b.url=e.path().replace("/",""),b.lectures||b.years||b.authors?(c.lectures=b.lectures,c.years=b.years,c.authors=b.authors):d({method:"GET",url:entuURL+"entity",params:{definition:"loeng"}}).success(function(e){b.lectures_count=e.result.length,b.lectures_loaded=0,b.lectures=[],b.years=[],b.authors=[];for(i in e.result)d({method:"GET",url:entuURL+"entity-"+e.result[i].id}).success(function(d){var e=toLecture(d.result);b.lectures.push(e),-1==b.years.indexOf(e.year)&&(b.years.push(e.year),b.years=b.years.sort(),b.years=b.years.reverse());for(a in e.authors)-1==b.authors.indexOf(e.authors[a])&&(b.authors.push(e.authors[a]),b.authors=b.authors.sort());c.lectures=b.lectures,c.years=b.years,c.authors=b.authors,b.lectures_loaded+=1})})}]).controller("lectureCtrl",["$rootScope","$scope","$http","$routeParams",function(a,b,c,d){a.url=d.id,c({method:"GET",url:entuURL+"entity-"+d.id}).success(function(a){b.lecture=toLecture(a.result)}),b.palyAudio=function(b){a.current_lecture=b}}]);
